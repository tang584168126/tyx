@{
    ViewBag.Title = "浏览问题";
    Layout = "~/Views/Shared/_common.cshtml";
}
@using Friends.Web.Helpers;
@using Friends.Business;

@model Friends.Models.Question

<h2>@Model.Title</h2>
<!--问题详细信息-->
<div class="quesDetail">
    <div style="font-size: 14px; margin-bottom: 5px;">
        <img src="~/images/icon-24.jpg" /
        <span style="font-weight: bold; color: red">悬赏青鸟豆：@Model.Prize</span>&nbsp;【@Model.State.ToQuestionState()】&nbsp;浏览：@Model.VisitCount 次
    </div>
    <div class="content">
       @Html.Raw(Model.Content)
    </div>
    <div style="width: 500px; float: left;">
        @foreach (var item in @Model.Tags)
        {
          <a class="tag">@item.TagName</a> 
        }
    </div>
    <div style="width: 40px; float: left;">
        <img src="~/images/upload/img-11.jpg" width="36" height="36" />
    </div>
    <div style="float: left;">
        @{
            var title = new TagSettingService().GetTitle(Model.User.InitialPrize);
        }
        <span>@Model.User.RealName</span>| @title |青鸟豆 @Model.User.InitialPrize 个
        <br />
        提问于：@Model.CreatedTime.ToSpanDays()
    </div>

</div>
<!--回答列表-->
<div class="quesList">
    <div style="background-color: #538ae6; width: 100%; height: 25px; font-weight: bold; padding-left: 5px;">所有回答</div>
    @foreach (var item in Model.Answers)
    {
       @Html.Partial("AnswerItem",item)
    }
   @* <div id ="ajaxUpdateAnswer"></div>*@

</div>
<!--回答问题-->
@if (Request.IsAuthenticated)
{
    using (Ajax.BeginForm("Answer", "Question", new AjaxOptions() { OnSuccess="loadAddedData" }))
    {
        
    <div>
        @Html.Hidden("answer.QuestionId", Model.QuestionId)
        <div>请输入您的解答,回答被采纳后可获得青鸟豆。</div>
        <div>@Html.TextArea("answer.Content", new { style = "width:360px" })
  <script type="text/javascript">
      CKEDITOR.replace('answer.Content');

 </script>
</div>
        <div style="padding:5px 5px 5px 5px ">
            <input type="submit" value="提交回答" class="button" /></div>
    </div>
    }



}
else
{
    <span>您需要</span>
    @Html.ActionLink("登录", "Login", "Account", new { returnUrl = Request.RawUrl }, null);
    <span>以后才能回答问题，未注册的用户可以先</span>
    @Html.ActionLink("注册", "Register", "Account");


}


@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
 
    <link href="~/Content/jquery.tagit.css" rel="stylesheet" />
    <script src="~/ckeditor/ckeditor.js"></script>
    <script type="text/javascript">
        $(function () { $(".button").button(); })
        //加载添加的数据
        function loadAddedData(data) {
            $("div.quesList").append($(data));
        }
    </script>
}